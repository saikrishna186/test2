/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/base/EventProvider","sap/ui/base/ObjectPool","./BaseNodeProxy","./NodeProxy"],function(q,l,E,O,B,N){"use strict";var g=sap.ui.vk.dvl.getJSONObject;var a=E.extend("sap.ui.vk.NodeHierarchy",{metadata:{publicMethods:["createNodeProxy","destroyNodeProxy","enumerateAncestors","enumerateChildren","getGraphicsCore","getScene"]},_baseNodeProxyPool:new O(B),constructor:function(s){E.apply(this);this._graphicsCore=s.getGraphicsCore();this._scene=s;this._dvlSceneId=this._scene._getDvlSceneId();this._dvl=this._graphicsCore._getDvl();this._nodeProxies=[];},destroy:function(){this._nodeProxies.slice().forEach(this.destroyNodeProxy.bind(this));this._dvl=null;this._dvlSceneId=null;this._scene=null;this._graphicsCore=null;E.prototype.destroy.apply(this);},getGraphicsCore:function(){return this._graphicsCore;},getScene:function(){return this._scene;},_getDvlSceneId:function(){return this._dvlSceneId;},enumerateChildren:function(n,c,s){if(typeof n==="function"){s=c;c=n;n=undefined;}var b;if(n){if(s||(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED)===0){b=g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN)).ChildNodes;}else{b=[];}}else{b=g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneId,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_CHILDREN)).ChildNodes;}var d=this._baseNodeProxyPool.borrowObject();try{b.forEach(function(n){d.init(this,n);c(d);d.reset();}.bind(this));}finally{this._baseNodeProxyPool.returnObject(d);}return this;},enumerateAncestors:function(n,c){var b=g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_PARENTS)).ParentNodes;var d=this._baseNodeProxyPool.borrowObject();try{b.forEach(function(n){d.init(this,n);c(d);d.reset();}.bind(this));}finally{this._baseNodeProxyPool.returnObject(d);}return this;},createNodeProxy:function(n){var b=new N(this,n);this._nodeProxies.push(b);return b;},destroyNodeProxy:function(n){var i=this._nodeProxies.indexOf(n);if(i>=0){this._nodeProxies.splice(i,1)[0].destroy();}return this;}});return a;});
